{
  "generated": "2026-02-19",
  "sitemap_type": "dynamic (Next.js MetadataRoute.Sitemap)",
  "file": "app/sitemap.ts",
  "total_lines": 304,
  "sitemap_url": "/sitemap.xml",
  "multi_site_aware": true,
  "site_id_source": "x-site-id header from middleware",
  "base_url_source": "x-hostname header from middleware, fallback www.yalla-london.com",
  "edge_cached": true,
  "cache_header": "s-maxage=3600, stale-while-revalidate=86400 (from next.config.js)",
  "url_categories": {
    "static_pages": {
      "count": 6,
      "urls": ["/", "/blog", "/recommendations", "/events", "/about", "/contact"],
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "currentDate (runtime, not actual content date)",
      "changeFrequency": "varies (daily to monthly)",
      "priority": "1.0 to 0.6"
    },
    "static_blog_posts": {
      "source": "data/blog-content.ts + data/blog-content-extended.ts",
      "condition": "siteId === 'yalla-london' only (hardcoded check at L108)",
      "filter": "published=true",
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "post.updated_at (actual content date)",
      "changeFrequency": "weekly",
      "priority": 0.8
    },
    "db_blog_posts": {
      "source": "prisma.blogPost.findMany({published: true, deletedAt: null, siteId})",
      "deduplication": "Excludes slugs already in static content via staticSlugs Set",
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "post.updated_at or currentDate fallback",
      "changeFrequency": "weekly",
      "priority": 0.8,
      "error_handling": "try/catch with empty fallback -- silent failure, no logging"
    },
    "db_events": {
      "source": "prisma.event.findMany({published: true, siteId or null})",
      "url_pattern": "/events/{id}",
      "hreflang": false,
      "hreflang_note": "MISSING -- events are the ONLY content type without hreflang alternates",
      "lastModified": "event.updated_at or currentDate fallback",
      "changeFrequency": "weekly",
      "priority": 0.7,
      "error_handling": "try/catch with empty fallback -- silent failure"
    },
    "categories": {
      "source": "Static categories array from data/blog-content.ts",
      "url_pattern": "/blog/category/{slug}",
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "currentDate",
      "changeFrequency": "weekly",
      "priority": 0.7,
      "multi_site_note": "Static categories are Yalla London-specific but served to all sites"
    },
    "information_hub": {
      "count": 2,
      "urls": ["/information", "/information/articles"],
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "currentDate",
      "changeFrequency": "weekly",
      "priority": "0.9 and 0.8"
    },
    "information_sections": {
      "source": "data/information-hub-content.ts informationSections (static, published only)",
      "url_pattern": "/information/{section_slug}",
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "currentDate (no actual modification date from static data)",
      "changeFrequency": "weekly",
      "priority": 0.8,
      "multi_site_note": "Static content, London-specific, but included for all sites"
    },
    "information_articles": {
      "source": "data/information-hub-content.ts + data/information-hub-articles-extended.ts (static, published only)",
      "url_pattern": "/information/articles/{slug}",
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "article.updated_at.toISOString() (actual content date)",
      "changeFrequency": "weekly",
      "priority": 0.8,
      "multi_site_note": "Static content, London-specific, but included for all sites"
    },
    "news_landing": {
      "count": 1,
      "urls": ["/news"],
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "currentDate",
      "changeFrequency": "daily",
      "priority": 0.8
    },
    "db_news_items": {
      "source": "prisma.newsItem.findMany({status: 'published', siteId})",
      "url_pattern": "/news/{slug}",
      "limit": 100,
      "hreflang": true,
      "hreflang_format": "en/ar",
      "x_default": false,
      "lastModified": "item.updated_at or currentDate fallback",
      "changeFrequency": "daily",
      "priority": 0.7,
      "error_handling": "try/catch with empty fallback -- silent failure"
    }
  },
  "hreflang_status": {
    "format_in_sitemap": "en/ar (bare language codes, ISO 639-1)",
    "format_in_html": "en-GB/ar-SA (BCP 47 with region)",
    "inconsistency": true,
    "x_default_in_sitemap": false,
    "x_default_in_html": true,
    "content_types_with_hreflang": [
      "static_pages",
      "static_blog_posts",
      "db_blog_posts",
      "categories",
      "information_hub",
      "information_sections",
      "information_articles",
      "news_landing",
      "db_news_items"
    ],
    "content_types_without_hreflang": [
      "db_events"
    ],
    "standards_compliance": {
      "TECHNICAL_SEO.hreflangBidirectional": "PASS -- en has ar alternate and vice versa",
      "TECHNICAL_SEO.hreflangIncludeXDefault": "FAIL -- sitemap lacks x-default"
    },
    "recommendations": [
      "Upgrade sitemap hreflang from en/ar to en-GB/ar-SA to match HTML metadata",
      "Add x-default alternate to all sitemap entries pointing to English URL",
      "Add hreflang alternates to event pages in sitemap"
    ]
  },
  "missing_pages": [
    { "path": "/experiences", "has_page_tsx": true, "has_layout_metadata": true, "priority_to_add": "MEDIUM" },
    { "path": "/hotels", "has_page_tsx": true, "has_layout_metadata": true, "priority_to_add": "MEDIUM" },
    { "path": "/privacy", "has_page_tsx": true, "has_layout_metadata": true, "priority_to_add": "LOW (but E-E-A-T trust)" },
    { "path": "/terms", "has_page_tsx": true, "has_layout_metadata": true, "priority_to_add": "LOW" },
    { "path": "/affiliate-disclosure", "has_page_tsx": true, "has_layout_metadata": false, "priority_to_add": "LOW (transparency)" },
    { "path": "/shop", "has_page_tsx": true, "has_layout_metadata": true, "priority_to_add": "MEDIUM (revenue)" },
    { "path": "/shop/[slug]", "has_page_tsx": true, "has_layout_metadata": true, "priority_to_add": "MEDIUM (revenue)" },
    { "path": "/london-by-foot", "has_page_tsx": true, "has_layout_metadata": false, "priority_to_add": "MEDIUM (unique content)" },
    { "path": "/london-by-foot/[slug]", "has_page_tsx": true, "has_layout_metadata": false, "priority_to_add": "MEDIUM" }
  ],
  "pages_that_should_be_noindex": [
    { "path": "/offline", "reason": "PWA offline fallback -- no search value" },
    { "path": "/shop/download", "reason": "Post-purchase download -- transactional only" },
    { "path": "/shop/purchases", "reason": "Purchase history -- authenticated only" }
  ],
  "scalability": {
    "current_estimated_urls": "100-200",
    "max_urls_per_sitemap": 50000,
    "max_size_per_sitemap_mb": 50,
    "sitemap_index_implemented": false,
    "per_language_sitemaps": false,
    "risk_level": "LOW currently, HIGH when scaling to 5 sites with 50+ articles each",
    "news_items_capped": "100 (older items silently dropped)",
    "recommendation": "Implement sitemap index with per-content-type sub-sitemaps before activating site #2"
  },
  "multi_site_behavior": {
    "site_scoping": "Reads x-site-id header from middleware",
    "static_blog_posts": "Only included when siteId === 'yalla-london' (hardcoded check L108)",
    "db_content": "Filtered by siteId in Prisma where clause",
    "events": "Filtered by siteId OR siteId null (shared events)",
    "static_content_issue": "informationSections, informationArticles, categories from static data files are London-specific but served to all sites"
  },
  "findings": [
    {
      "id": "SITEMAP-001",
      "severity": "HIGH",
      "description": "Hreflang codes use bare en/ar instead of en-GB/ar-SA, creating inconsistency with HTML metadata.",
      "recommendation": "Change all alternates.languages keys from 'en'/'ar' to 'en-GB'/'ar-SA'."
    },
    {
      "id": "SITEMAP-002",
      "severity": "HIGH",
      "description": "No x-default hreflang alternate in sitemap. standards.ts requires it (TECHNICAL_SEO.hreflangIncludeXDefault = true).",
      "recommendation": "Add 'x-default' key to all alternates.languages objects pointing to the English URL."
    },
    {
      "id": "SITEMAP-003",
      "severity": "HIGH",
      "description": "Event pages have no hreflang alternates while all other content types do.",
      "recommendation": "Add alternates.languages to event sitemap entries with en-GB/ar-SA/x-default keys."
    },
    {
      "id": "SITEMAP-004",
      "severity": "HIGH",
      "description": "8+ indexable public pages missing from sitemap: /experiences, /hotels, /privacy, /terms, /affiliate-disclosure, /shop, /shop/[slug], /london-by-foot, /london-by-foot/[slug].",
      "recommendation": "Add entries to sitemap.ts for each missing page type."
    },
    {
      "id": "SITEMAP-005",
      "severity": "MEDIUM",
      "description": "No sitemap index strategy for multi-site scaling. Single flat sitemap for all content.",
      "recommendation": "Implement sitemap index with sub-sitemaps per content type before second site activation."
    },
    {
      "id": "SITEMAP-006",
      "severity": "MEDIUM",
      "description": "Static content (info sections, categories) is London-specific but included in all sites' sitemaps.",
      "recommendation": "Add site-scoping logic to static content inclusion."
    },
    {
      "id": "SITEMAP-007",
      "severity": "LOW",
      "description": "currentDate used as lastModified for static pages -- tells crawlers content changes every request.",
      "recommendation": "Use build timestamp or actual content modification dates."
    },
    {
      "id": "SITEMAP-008",
      "severity": "LOW",
      "description": "News items capped at 100. Older news will silently drop from sitemap without warning.",
      "recommendation": "Add pagination or increase limit with monitoring."
    },
    {
      "id": "SITEMAP-009",
      "severity": "LOW",
      "description": "DB query error handling silently returns empty arrays. Sitemap degradation not visible in monitoring.",
      "recommendation": "Add logging to catch blocks."
    }
  ]
}
